## 一、数据库管理系统DBMS

![数据库语言.PNG](https://i.loli.net/2018/08/06/5b68083dd2a93.png)

![数据库管理系统.PNG](https://i.loli.net/2018/08/06/5b68084f305aa.png)

## 二、数据库的标准结构

### 三级模式两层映像

![三级模式.PNG](https://i.loli.net/2018/08/06/5b68098f33a1f.png)

![两层映像.PNG](https://i.loli.net/2018/08/06/5b68099d8b5f7.png)

![三级模式两层映像.PNG](https://i.loli.net/2018/08/06/5b680a1146c7e.png)

### 两个独立性

![两个独立性.PNG](https://i.loli.net/2018/08/06/5b680c3ab16b0.png)

### 模式&数据&数据模型

![数据与模式.PNG](https://i.loli.net/2018/08/06/5b680c3fee71a.png)

![模式与数据模型.PNG](https://i.loli.net/2018/08/06/5b6839ffd4836.png)

### 三大经典数据模型

![三大经典数据模型.PNG](https://i.loli.net/2018/08/06/5b683a0b9f54c.png)

![关系模型.PNG](https://i.loli.net/2018/08/06/5b6843400ecdb.png)

![层次模型.PNG](https://i.loli.net/2018/08/06/5b684340247fa.png)

![网状模型.PNG](https://i.loli.net/2018/08/06/5b68433f39bac.png)

### 总结

![总结.PNG](https://i.loli.net/2018/08/06/5b684754b16b7.png)

## 三、关系模型

### 定义

![关系模型的定义.PNG](https://i.loli.net/2018/08/06/5b6848518d54f.png)

### 关系模型三要素

![关系模型三要素.PNG](https://i.loli.net/2018/08/06/5b684854791cc.png)

### 关系运算

**关系运算包括关系代数和关系演算，关系演算包括元组演算和域演算**

![关系代数.PNG](https://i.loli.net/2018/08/10/5b6d83f2a825f.png)

![元组演算.PNG](https://i.loli.net/2018/08/10/5b6d83f1ee9e0.png)

![域演算.PNG](https://i.loli.net/2018/08/10/5b6d83f2a0e5b.png)

### 若干基本概念

**域(Domain)**：列的取值范围，具有相同的数据类型的集合，**域的基数(Cardinality)**为集合中元素的个数

**笛卡尔积(Cartesian Product)**：一组域D~1~ , D~2~ ,…, D~n~的笛卡尔积为：D~1~×D~2~×D~n~ = { (d~1~ , d~2~ , … , d~n~) | d~i~∈D~i~ , i=1,…,n }

**n-元组（n-tuple）**：笛卡尔积的每个元素(d~1~ , d~2~ , … , d~n~)

- 元组(d~1~ , d~2~ , … , d~n~)是从每一个域任取一个值所形成的一种组合，笛卡尔积是所有这种可能组合的集合， 即：笛卡尔积是由n个域形成的所有可能的n-元组的集合
- 若D~i~的基数为m~i~，则笛卡尔积的基数即元组个数为m~1~*m~2~…m~n~

**分量(component)**：元组(d~1~ , d~2~ , … , d~n~)的每一个值d~i~

**关系(Relation)**：一组域D~1~ , D~2~ ,…, D~n~的笛卡尔积的子集。笛卡尔积中具有某一方面意义的那些元组被称作一个关系。【笛卡尔积中的所有元组并不都是有意义的】

​	关系可用R(A~1~:D~1~ , A~2~:D~2~ , … , A~n~:D~n~ )表示，可简记为R(A~1~ , A~2~ ,…, A~n~)，这种描述又被称为关系模式(Schema)或表标题(head)。其中，R是关系的名字，A~i~ 是属性，D~i~ 是属性所对应的域，n是关系的**度或目(degree)**，关系中元组的数目称为**关系的基数(Cardinality)**

**候选码(Candidate Key)/候选键**：关系中的一个属性组，其值能唯一标识一个元组，若从该属性组中去掉任何一个属性，它就不具有这一性质了，这样的属性组称作候选码。

- 关系中可以有很多组候选码
- 候选码可能包含一个或多个属性。若所有属性构成这个关系的候选码，则称为**全码(All-Key)**

**主码(Primary Key)/主键**：当有多个候选码时，可以选定一个作为主码。DBMS以主码为主要线索管理关系中的各个元组。

**主属性与非主属性**：包含在任何一个候选码中的属性被称作主属性，而其他属性被称作非主属性。

**外码(Foreign Key)/外键**：关系R中的一个属性组，若它不是R的候选码，但与另一个关系S的候选码相对应，则称这个属性组为R的外码或外键。

- 两个关系通常是靠外码连接起来的。

### 关系模式&关系

同一关系模式下，可有很多的关系
关系模式是关系的结构, 关系是关系模式在某一时刻的数据

### 关系的特性

同列一定同域，不同列不一定不同域。

区分不同列靠列名，区分不同行靠一列或几列的值（关键字/键字/码字）。行互换和列互换对关系无影响。

理论上，关系中不能有重复元祖。但是实际表中可能有重复元祖。

**关系第一范式：属性不可再分特性**

### 关系模型中的完整性

1. **实体完整性**：关系的**主码**中的属性值不能为空值。若主码为空，则出现不可标识
   的个体，这是不容许的（**空值**：不知道、不存在或无意义的值，关系模型中用 ? 表征）
2. **参照完整性**：如果关系R~1~的**外码**F~k~与关系R~2~的主码P~k~相对应，则R~1~中的每一个元组的F~k~值或者等于R~2~中某个元组的P~k~值，或者为空值
3. **用户自定义完整性**：用户针对具体的应用环境定义的完整性约束条件

## 四、关系运算

### 关系代数

关系代数操作可分为集合操作和纯关系操作

![关系代数操作.PNG](https://i.loli.net/2018/08/11/5b6ee5e590c8b.png)

#### **并相容性**

关系R与关系S存在相容性，当且仅当：
(1) 关系R和关系S的属性数目必须相同；
(2) 对于任意i，关系R的第i个属性的域必须和关系S的第i个属性的域相同

假设：R(A~1~, A~2~, … , A~n~) , S(B~1~, B~2~, … ,B~m~)
R和S满足并相容性：n = m 并且Domain(A~i~) = Domain(B~i~)

##### 1.并 

![并.PNG](https://i.loli.net/2018/08/12/5b701d72b3b3d.png) 

##### 2.差

![差.PNG](https://i.loli.net/2018/08/12/5b701c2624937.png)  

##### 3.广义笛卡尔积

![广义笛卡尔积.PNG](https://i.loli.net/2018/08/12/5b701b0f93658.png) 

![广义笛卡尔积性质.PNG](https://i.loli.net/2018/08/12/5b701c021a0bf.png) 

##### 4.选择

![选择.PNG](https://i.loli.net/2018/08/12/5b70234820656.png)

​	运算符的优先次序自高至低为![运算次序.PNG](https://i.loli.net/2018/08/12/5b702471629b8.png)，其中$\theta$表示比较运算符，包括 >、<、= 等。 

##### 5.投影

![投影.PNG](https://i.loli.net/2018/08/13/5b70ec4ba91a3.png)

​	如果投影后有重复元组，则应去掉。

##### 6.交

![交.PNG](https://i.loli.net/2018/08/13/5b70edb848e6d.png)

##### 7.$\theta$-连接

![theta连接标题.PNG](https://i.loli.net/2018/08/13/5b70f1789e1b9.png)

![theta连接.PNG](https://i.loli.net/2018/08/13/5b70f185a8ae2.png)

​	可以看做使用笛卡尔积然后再进行选择来得到$\theta$-连接结果。但当引入$\theta$-连接操作后，DBMS可直接进行连接操作，而不必先形成笛卡尔积。

注：**$\rho$为表更名操作**，当一个表需要和其自身进行连接运算时，通常要使用更名操作

##### 8.等值连接

![等值连接.PNG](https://i.loli.net/2018/08/13/5b70f7a32d784.png)

​	广义积的元组组合并不是都有意义的，另广义积的元组组合数目也非常庞大，因此采用$\theta$-连接/等值连接运算可大幅度降低中间结果的保存量，提高速度。

##### 9.自然连接

![自然连接.PNG](https://i.loli.net/2018/08/13/5b70f8717d3fd.png)

##### 10.除

![除.PNG](https://i.loli.net/2018/08/13/5b712e597e601.png)

![除数学定义.PNG](https://i.loli.net/2018/08/13/5b713532141f3.png)

![除结果.PNG](https://i.loli.net/2018/08/13/5b7133f89ab49.png)

![除结果2.PNG](https://i.loli.net/2018/08/13/5b7133fd4cc2d.png)

![除 示例.PNG](https://i.loli.net/2018/08/13/5b7135827c312.png)

##### 11.外连接

**定义**：两个关系R与S进行连接时，如果关系R(或S)中的元组在S(或R)中找不到相匹配的元组，则为了避免该元组信息丢失，从而将该元组与S(或R)中假定存在的全为空值的元组形成连接，放置在结果关系中，这种连接称之为外连接(Outer Join)。

![外连接.PNG](https://i.loli.net/2018/08/13/5b713bf7afae1.png)

#### 书写代数表达式思路

![书写代数表达式思路.PNG](https://i.loli.net/2018/08/13/5b712d2a3e2ea.png)

#### 总结

![关系代数总结.PNG](https://i.loli.net/2018/08/13/5b70ecfd1cc03.png)

### 关系演算

关系演算是以数理逻辑中的谓词演算为基础的

#### 元组演算

##### 定义

![关系元组演算.PNG](https://i.loli.net/2018/08/13/5b71808a77c1c.png)

![元组演算.PNG](https://i.loli.net/2018/08/13/5b71800101093.png)

##### 存在量词&全称量词

![量词.PNG](https://i.loli.net/2018/08/13/5b71832eb8768.png)

当涉及两个表时，

{t|t $\in$ R~1~ $\wedge$ $\forall$或$\exist$ (u $\in$R~2~ $\wedge$ t[S#] = u[S#]) (约束条件)}

##### 等价性变换

![等价性变换.PNG](https://i.loli.net/2018/08/14/5b723d31c7a89.png)

![等价性变换2.PNG](https://i.loli.net/2018/08/14/5b723d303bb81.png)

##### 重要例题

![例子1.PNG](https://i.loli.net/2018/08/14/5b7249185f251.png)

![例子2.PNG](https://i.loli.net/2018/08/14/5b7249122af09.png)

![例子3.PNG](https://i.loli.net/2018/08/14/5b7249118abe6.png)

![例子4.PNG](https://i.loli.net/2018/08/14/5b72491450bbf.png)

##### 关系代数转元组演算

需满足一定前提条件

![关系代数转元组演算.PNG](https://i.loli.net/2018/08/14/5b7286e96687a.png)

#### 域演算

##### 定义

![域演算.PNG](https://i.loli.net/2018/08/14/5b7288115de94.png)

##### 元组演算和域演算

![元组演算和域演算.PNG](https://i.loli.net/2018/08/14/5b728a63c33d1.png)

##### 域演算语言QBE

​	操作独特，基于屏幕表格的查询语言，不用书写复杂的公式，只需将条件填在表格中即可。具体规则见课件。

![QBE.PNG](https://i.loli.net/2018/08/14/5b728a4bee52b.png)

### 关系运算的安全性

![关系运算的安全性.PNG](https://i.loli.net/2018/08/14/5b728bd3efb79.png)

#### 安全约束有效集合DOM

![安全约束有效集合.PNG](https://i.loli.net/2018/08/14/5b728e5342426.png)

![安全表达式.PNG](https://i.loli.net/2018/08/14/5b7296bdb68d9.png)

### 总结

![关系运算总结.PNG](https://i.loli.net/2018/08/14/5b729971597d4.png)

![关系运算总结.PNG](https://i.loli.net/2018/08/14/5b72993e0c389.png)

## 五、SQL语言

